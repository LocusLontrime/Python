# accepted on codewars.com
from collections import defaultdict as d, deque as dq


def processes(start, end, processes_: list[list[str]]) -> list[str]:
    # at first let us remake processes_ to the dict:
    processes_dict = d(list[tuple[str, str]])

    for name, start_, end_ in processes_:
        processes_dict[start_].append((end_, name))                                   # 36 366 98 989 98989 LL

    print(f'{processes_dict = }')

    prevs = {}

    to_be_visited = dq()
    to_be_visited.append(start)

    # now bfs:
    while to_be_visited:
        node_ = to_be_visited.popleft()
        print(f'{node_ = }')

        # check for the end point reached:
        if node_ == end:
            print(f'FOUND!')
            break

        for next_node_, name_ in processes_dict[node_]:
            if next_node_ not in prevs.keys():
                print(f'...{next_node_ = }')
                # visiting:
                prevs[next_node_] = node_, name_
                # adding to deque:
                to_be_visited.append(next_node_)

    # path restoring:
    path = []
    node_ = end
    while node_ != start and node_ in prevs.keys():
        node_, pp = prevs[node_]
        path.append(pp)

    return path[::-1]


test_processes = [
    ['gather', 'field', 'wheat'],
    ['bake', 'flour', 'bread'],
    ['mill', 'wheat', 'flour']
]

start_1, end_1, test_processes_1 = ('3', '4', [('xl', '4', '3'), ('mc', '2', '3'), ('zgj', '1', '1'), ('bb', '1', '2'), ('ghw', '2', '1'), ('fjw', '2', '4')])
start_2, end_2, test_processes_2 = ('51', '18', [('hyl', '56', '8'), ('med', '31', '14'), ('gws', '47', '23'), ('jbb', '45', '4'), ('cd', '41', '42'), ('ia', '23', '54'), ('hi', '23', '57'), ('opm', '22', '42'), ('dm', '32', '57'), ('xbh', '6', '16'), ('iua', '58', '19'), ('cy', '22', '55'), ('ac', '15', '44'), ('nx', '21', '29'), ('fmm', '27', '21'), ('efw', '40', '10'), ('ik', '6', '23'), ('nho', '3', '45'), ('jq', '43', '56'), ('uag', '48', '48'), ('gah', '43', '43'), ('dvk', '9', '39'), ('ly', '41', '24'), ('usw', '26', '35'), ('zgt', '36', '26'), ('kh', '50', '3'), ('yw', '40', '37'), ('ypt', '38', '26'), ('jy', '32', '24'), ('rn', '11', '9'), ('wyb', '21', '45'), ('byy', '18', '6'), ('dt', '59', '1'), ('pkq', '19', '48'), ('lq', '15', '45'), ('ylm', '14', '51'), ('btq', '18', '51'), ('bo', '3', '18'), ('ps', '22', '48'), ('ka', '46', '44'), ('wxj', '42', '58'), ('mb', '1', '10'), ('wdd', '25', '16'), ('npd', '52', '8'), ('bdi', '25', '13'), ('tyw', '55', '28'), ('gkx', '51', '5'), ('evi', '24', '5'), ('ca', '26', '47'), ('myc', '20', '2'), ('vp', '45', '21'), ('uee', '41', '22'), ('fp', '1', '14'), ('na', '17', '27'), ('zns', '18', '58'), ('vm', '22', '21'), ('lh', '6', '45'), ('tng', '31', '42'), ('pr', '1', '8'), ('pb', '33', '58'), ('wui', '13', '23'), ('pg', '49', '27'), ('qsr', '31', '55'), ('be', '14', '50'), ('gq', '7', '23'), ('ep', '20', '32'), ('qk', '25', '49'), ('yt', '50', '30'), ('ic', '12', '41'), ('uk', '6', '35'), ('tkm', '57', '25'), ('ovj', '6', '43'), ('tua', '4', '47'), ('tl', '17', '12'), ('cg', '17', '38'), ('fb', '23', '20'), ('ywu', '57', '51'), ('hee', '59', '44'), ('lbn', '53', '1'), ('ptw', '24', '51'), ('dey', '17', '15'), ('rmb', '6', '18'), ('cic', '42', '45'), ('kve', '57', '36'), ('hor', '48', '28'), ('al', '51', '36'), ('ne', '54', '32'), ('lnl', '21', '4'), ('js', '49', '15'), ('tz', '49', '31'), ('qlh', '23', '41'), ('bm', '12', '44'), ('mnm', '56', '11'), ('ok', '51', '16'), ('zln', '12', '3'), ('yk', '24', '41'), ('fni', '32', '58'), ('ul', '6', '59'), ('ol', '3', '1'), ('dn', '38', '5'), ('vs', '10', '17'), ('jez', '47', '12'), ('puz', '50', '38'), ('so', '45', '8'), ('blj', '58', '40'), ('dy', '46', '27'), ('my', '56', '6'), ('mi', '23', '49'), ('lea', '33', '9'), ('egz', '57', '8'), ('om', '54', '57'), ('kcv', '31', '22'), ('axw', '1', '57'), ('nf', '18', '43'), ('qx', '5', '52'), ('yca', '43', '13'), ('dg', '49', '48'), ('tmj', '28', '57'), ('blt', '38', '6'), ('im', '2', '47'), ('xd', '40', '53'), ('aab', '43', '58'), ('uy', '18', '18'), ('ao', '40', '11'), ('meq', '7', '35'), ('po', '4', '48'), ('hq', '51', '2'), ('lz', '13', '30'), ('oug', '43', '50'), ('qw', '12', '35'), ('jxi', '53', '3'), ('mp', '30', '13'), ('iiq', '2', '12'), ('wzz', '52', '5'), ('oi', '49', '22'), ('en', '12', '30'), ('ay', '31', '19'), ('kid', '2', '42'), ('cqn', '38', '36'), ('mjp', '55', '11'), ('iiz', '51', '45'), ('oif', '8', '50'), ('quy', '31', '13'), ('iz', '14', '47'), ('hn', '11', '50'), ('rxz', '2', '15'), ('iay', '36', '13'), ('xru', '4', '22'), ('co', '48', '7'), ('bg', '35', '46'), ('vwy', '23', '35'), ('hr', '27', '53'), ('cka', '10', '26'), ('gfx', '5', '3'), ('zsr', '25', '12'), ('bi', '24', '9'), ('cjs', '38', '58'), ('eme', '3', '49'), ('xe', '8', '49'), ('rme', '27', '5'), ('mxi', '24', '35'), ('za', '16', '41'), ('jps', '9', '16'), ('qt', '12', '47'), ('oyf', '29', '6'), ('jvy', '19', '57'), ('rpo', '45', '54'), ('mw', '48', '40'), ('oz', '8', '29'), ('ww', '50', '21'), ('rl', '59', '42'), ('aty', '8', '2'), ('ut', '45', '7'), ('fht', '9', '58'), ('ngp', '45', '31'), ('zdi', '37', '19'), ('iv', '16', '50'), ('ckr', '36', '8'), ('izz', '52', '20'), ('fj', '55', '25'), ('zt', '5', '14'), ('an', '21', '10'), ('ai', '35', '47'), ('no', '1', '6'), ('hk', '27', '6'), ('bx', '2', '48'), ('rdz', '58', '23'), ('tce', '15', '3'), ('bdw', '40', '58'), ('iso', '23', '47'), ('zs', '7', '33'), ('kyd', '45', '40'), ('wzp', '19', '24'), ('bvd', '50', '17'), ('hll', '49', '37'), ('azm', '40', '50'), ('khs', '16', '3'), ('fpc', '12', '33'), ('tv', '1', '51'), ('vw', '49', '28'), ('try', '10', '57'), ('bd', '55', '13'), ('pfg', '35', '38'), ('cm', '29', '10'), ('fq', '54', '36'), ('lqc', '50', '10'), ('pzx', '40', '44'), ('dpx', '27', '36'), ('vq', '23', '38'), ('tc', '6', '49'), ('nlh', '15', '28'), ('pv', '11', '30'), ('awl', '27', '13'), ('ke', '23', '15'), ('db', '18', '20'), ('lc', '22', '5'), ('rg', '47', '37'), ('lrc', '50', '37'), ('kr', '54', '34'), ('ax', '43', '27'), ('wxm', '29', '28'), ('hm', '18', '52'), ('pd', '43', '59'), ('lvz', '47', '28'), ('ii', '47', '8'), ('klo', '53', '38'), ('vaj', '2', '17'), ('zdg', '36', '18'), ('xie', '19', '6'), ('usa', '59', '22'), ('ln', '31', '54'), ('nfk', '54', '39'), ('phf', '8', '27'), ('scr', '11', '47'), ('ipn', '10', '53'), ('zu', '44', '44'), ('qaq', '43', '4'), ('fk', '25', '17'), ('ze', '50', '46'), ('hh', '34', '57'), ('pc', '5', '12'), ('lqt', '22', '25'), ('kkn', '12', '21'), ('wb', '25', '3'), ('awk', '54', '2'), ('ef', '43', '33'), ('gj', '26', '7'), ('wn', '3', '12'), ('nk', '36', '59'), ('fkr', '18', '44'), ('eu', '19', '36'), ('fxz', '5', '55'), ('wmo', '31', '24'), ('zal', '32', '20'), ('jp', '39', '45'), ('wy', '23', '52'), ('we', '55', '9'), ('ng', '7', '17'), ('cjp', '48', '39'), ('vsw', '50', '56'), ('wbr', '57', '16'), ('mnk', '44', '45'), ('rqz', '9', '27'), ('yyw', '1', '32'), ('mkn', '19', '34'), ('wqi', '23', '21'), ('tj', '21', '7'), ('idf', '57', '41'), ('ed', '22', '58'), ('sj', '7', '10'), ('mdy', '37', '31'), ('azr', '27', '9'), ('mx', '22', '50'), ('ci', '15', '7'), ('qe', '16', '12'), ('obx', '6', '47'), ('vhn', '39', '18'), ('gu', '32', '50'), ('lrf', '37', '24'), ('eug', '5', '48'), ('csc', '59', '8'), ('xm', '29', '7'), ('kem', '7', '37'), ('hsa', '50', '7'), ('odj', '47', '31'), ('yp', '3', '48'), ('bqa', '10', '23'), ('jx', '28', '30'), ('ty', '28', '18'), ('xii', '6', '12'), ('fsq', '57', '3'), ('qxv', '12', '28'), ('jnh', '57', '29'), ('id', '37', '11'), ('ts', '8', '52'), ('yx', '53', '17'), ('egj', '4', '5'), ('te', '27', '59'), ('sw', '36', '51'), ('su', '8', '21'), ('sc', '30', '16'), ('ski', '38', '20'), ('ssq', '29', '11'), ('oyl', '21', '6'), ('bj', '36', '16'), ('gdc', '40', '1'), ('bbz', '42', '7'), ('gz', '44', '12'), ('fh', '58', '1'), ('wik', '41', '35'), ('sm', '22', '35'), ('dc', '44', '4'), ('rvm', '16', '52'), ('oab', '45', '18'), ('ixz', '27', '33'), ('fr', '41', '30'), ('ucd', '48', '59'), ('ch', '25', '7'), ('fuj', '25', '15'), ('iwc', '12', '56'), ('tll', '25', '55'), ('ox', '17', '13'), ('oe', '57', '30'), ('vr', '3', '10'), ('bn', '8', '10'), ('tlz', '11', '10'), ('bfo', '31', '44'), ('zzy', '29', '25'), ('tw', '58', '16'), ('xno', '47', '25'), ('qg', '4', '16'), ('if', '49', '58'), ('ese', '29', '51'), ('ht', '34', '44'), ('bem', '49', '34'), ('ey', '26', '8'), ('vyb', '4', '23'), ('pic', '7', '55'), ('lim', '37', '34'), ('wir', '12', '42'), ('xyb', '17', '39'), ('vhb', '11', '28'), ('yg', '32', '27'), ('ojo', '50', '36'), ('sh', '44', '48'), ('gp', '51', '47'), ('wwv', '49', '39'), ('mn', '1', '20'), ('hx', '28', '20'), ('qd', '41', '4'), ('knr', '50', '58'), ('tnx', '14', '11'), ('wft', '57', '12'), ('un', '14', '48'), ('fwo', '18', '48'), ('yq', '42', '6'), ('jjw', '42', '21'), ('qy', '3', '26'), ('uu', '20', '17'), ('rm', '26', '32'), ('di', '5', '32'), ('ck', '31', '35'), ('kc', '16', '14'), ('az', '32', '15'), ('tm', '56', '46'), ('ppi', '7', '11'), ('kj', '35', '40'), ('zay', '7', '5'), ('eqo', '36', '35'), ('kz', '16', '8'), ('fm', '25', '22'), ('aa', '33', '52'), ('uua', '48', '20'), ('wa', '2', '36'), ('dzd', '38', '46'), ('zro', '14', '22'), ('yu', '53', '7'), ('dz', '6', '37'), ('cu', '48', '52'), ('kpy', '22', '1'), ('lt', '57', '1'), ('dyw', '56', '27'), ('dcv', '59', '25'), ('xaw', '28', '49'), ('huu', '17', '18'), ('to', '31', '47'), ('mec', '21', '43'), ('epg', '28', '29'), ('dae', '5', '7'), ('lg', '7', '51'), ('xg', '38', '27'), ('dba', '39', '14'), ('oq', '21', '18'), ('gmi', '11', '42'), ('wq', '40', '26'), ('ury', '12', '25'), ('rpr', '14', '19'), ('hqh', '13', '36'), ('tva', '30', '4'), ('vc', '3', '55'), ('rky', '11', '15'), ('omg', '7', '36'), ('imy', '50', '9'), ('ie', '21', '57'), ('dhp', '48', '49'), ('bds', '26', '24'), ('lky', '17', '59'), ('hg', '59', '34'), ('rad', '35', '25'), ('zww', '51', '21'), ('dw', '29', '18'), ('jln', '34', '12'), ('kd', '55', '26'), ('zcy', '24', '6'), ('tlj', '14', '37'), ('fes', '21', '59'), ('usm', '40', '47'), ('mns', '12', '34'), ('gx', '19', '44'), ('kmy', '33', '28'), ('oc', '33', '8'), ('mu', '2', '45'), ('jfi', '9', '42'), ('vh', '16', '55'), ('wk', '45', '3'), ('np', '10', '41'), ('bu', '28', '26'), ('xr', '22', '3'), ('mg', '15', '24'), ('ql', '55', '47'), ('gbc', '50', '59'), ('spj', '58', '4'), ('pkh', '16', '24'), ('xa', '39', '47'), ('orw', '57', '10'), ('brh', '40', '55'), ('krj', '52', '38'), ('qcl', '15', '53'), ('mj', '38', '48'), ('kn', '45', '14'), ('pjd', '55', '12'), ('qa', '28', '47'), ('epr', '41', '28'), ('sf', '48', '30'), ('aex', '31', '52'), ('izd', '6', '40'), ('itz', '55', '42'), ('lu', '32', '37'), ('nxo', '23', '39'), ('gb', '57', '14'), ('ld', '7', '45'), ('myg', '39', '42'), ('ozl', '24', '37'), ('pf', '3', '51'), ('qo', '31', '21'), ('wv', '14', '56'), ('cjd', '27', '38'), ('xzk', '54', '42'), ('rwk', '24', '8'), ('bbe', '38', '22'), ('xp', '13', '43'), ('pzq', '1', '15'), ('lsc', '14', '18'), ('oaw', '41', '46'), ('xz', '21', '25'), ('gs', '45', '30'), ('xqy', '44', '55'), ('sz', '6', '11'), ('qjn', '21', '51'), ('zo', '21', '20'), ('yj', '37', '20'), ('mnn', '16', '22'), ('nz', '18', '54'), ('zf', '42', '40'), ('dwn', '57', '26'), ('hoy', '3', '23'), ('zz', '42', '24'), ('pi', '30', '19'), ('poh', '15', '20'), ('fi', '5', '50'), ('ecn', '18', '7'), ('kgh', '3', '34'), ('foo', '25', '24'), ('dd', '17', '50'), ('gie', '19', '27'), ('jz', '37', '41'), ('fy', '40', '22'), ('hpi', '24', '32'), ('he', '5', '39'), ('wp', '12', '54'), ('dyp', '57', '56'), ('pm', '30', '37'), ('mz', '15', '23'), ('bpt', '17', '44'), ('yoh', '35', '18'), ('ds', '52', '21'), ('tf', '15', '34'), ('fc', '17', '3'), ('iw', '47', '16'), ('kk', '23', '18')])


# print(f"res: {processes('field', 'bread', test_processes)}")  # should return ['gather', 'mill', 'bake']
print(f'res: {processes(start_2, end_2, test_processes_2)}')





